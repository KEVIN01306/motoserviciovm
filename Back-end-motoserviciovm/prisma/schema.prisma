// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}




model Sucursal {
  id              Int @id @default(autoincrement())
  nombre          String @unique
  direccion       String
  telefono        String
  email           String

  usuarios        User[] @relation("UserSucursales")

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])
}

model User {
  id              Int @id @default(autoincrement())
  primerNombre    String
  segundoNombre   String?
  primerApellido  String
  segundoApellido String?
  fechaNac        DateTime
  dpi             String?
  nit             String?        
  tipo            String?
  activo          Boolean @default(true)
  numeroTel       String  
  numeroAuxTel    String?
  email           String  @unique
  password        String?

  roles           Rol[] @relation("UserRoles")

  sucursales      Sucursal[] @relation("UserSucursales")

  motos           Moto[] @relation("UserMotos")

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Rol {
  id              Int @id @default(autoincrement())
  rol             String @unique
  descripcion     String?

  usuarios        User[] @relation("UserRoles")
  permisos        Permiso[] @relation("RolPermisos")

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}


model Permiso {
  id              Int @id @default(autoincrement())
  permiso         String @unique
  modulo          String?
  roles           Rol[] @relation("RolPermisos")

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}



model Marca {
  id              Int @id @default(autoincrement())
  marca           String @unique

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  modelos         Modelo[]

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Linea {
  id              Int @id @default(autoincrement())
  linea           String @unique

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  modelos         Modelo[]

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Cilindrada {
  id              Int @id @default(autoincrement())
  cilindrada      Int @unique

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  modelos         Modelo[]

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Modelo {
  id              Int @id @default(autoincrement())
  a√±o             Int

  modelo          String @unique

  marcaId         Int
  marca           Marca @relation(fields: [marcaId], references: [id])

  lineaId         Int
  linea           Linea @relation(fields: [lineaId], references: [id])

  cilindradaId    Int
  cilindrada      Cilindrada @relation(fields: [cilindradaId], references: [id])    

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])

  motos           Moto[]

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Estado {
  id              Int @id @default(autoincrement())
  estado          String @unique

  motos           Moto[]
  users           User[]
  sucursales      Sucursal[]
  roles           Rol[]
  permisos        Permiso[]
  marcas          Marca[]
  lineas          Linea[]
  cilindradas     Cilindrada[]
  modelos         Modelo[]

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Moto {
  id              Int @id @default(autoincrement())

  placa           String @unique
  avatar          String?
  
  modeloId        Int
  modelo          Modelo @relation(fields: [modeloId], references: [id])

  users           User[] @relation("UserMotos")

  estadoId        Int
  estado          Estado @relation(fields: [estadoId], references: [id])


  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
} 